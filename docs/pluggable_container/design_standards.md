---
title: 容器设计标准
date: 2024-04-17 15:43:00
---

## 兼容性需求

1. 插件化引擎支持市场上主流的XR眼镜的安卓系统版本（安卓6.0到的安卓14的兼容）
2. 封装的UI组件逻辑层兼容市场上主流的XR眼镜设备的语音指令、各类触摸板和旋钮等设备的操作交互
3. 对麦克风和相机焦点的处理

## 架构方面需求

- SDK包括若干组API，用于与插件平台系统的各个系统服务进行交互或取得额外的能力。
- 支持`armv7`和`armv8`架构
- 插件化相关代码编译后体积方面尽可能小
- 不允许存在与插件化相关的闭源代码和恶意后门，如部分闭源so库（工业领域和国企的移动安全要求）

## 功能性需求

### 相互通信需求

1. 宿主可以对插件的`Runtime`进行`Hook`，也即对插件apk调用的指定的`class`和`class->method`进行Hook。达到插件调用插件自身dex里没有的`java class`时能成功的从宿主的`classloader`中`findClass`到的效果；并且宿主能控制插件apk调用`class->method`的具体返回值和执行逻辑（IAT）；也即插件能调用宿主相关类和方法。
2. 插件能调用宿主的`Activity`并通过`onActivityResult`拿到返回数据，和1实现方式可能稍有区别（普通类和`Activity`，也可能不需要处理）
3. 宿主能反射调用插件的`Activity`和任意`java class`

### 插件应用管理需求

1. 宿主可以通过一定的管理接口管理插件APK的虚拟化数据目录、GPS位置、一些需要运行时权限的功能可以做到权限隔离，在宿主拥有`Camera`权限时禁止插件使用`Camera`，并抛出权限不足的异常。
2. 宿主包含对插件APK的管理接口
